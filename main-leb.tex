\documentclass[twopage,twocolumn,showtrims,10pt]{memoir}


\setstocksize{228.6mm}{152.4mm}% 6in x 9in
\settrimmedsize{8.5in}{5.5in}{*}
\settrims{.25in}{.25in}

\setcolsepandrule{4.5mm}{0pt}

\setulmarginsandblock{12mm}{9mm}{1}

\setlrmarginsandblock{13.5mm}{7.5mm}{*}

\checkandfixthelayout 


\quarkmarks

%\usepackage{atbegshi}
%\AtBeginShipout{\special{pdf: put @thispage <</TrimBox [36.0 36.0 612 810]>>}}
%\special{pdf: put @thispage <</TrimBox [36.0 36.0 612 810]>>}


%\usepackage[pass,b5paper,inner=16mm,outer=12mm,top=24mm,bottom=8mm]{geometry}
\usepackage{lipsum}
\usepackage{fixltx2e}
\usepackage{xspace}
\usepackage[usenames,dvipsnames,svgnames,table]{xcolor}
\usepackage{lettrine}
\usepackage{flushend}
\usepackage{fancyhdr}
\usepackage{hyperref}
\usepackage{microtype}
\usepackage[object=vectorian]{pgfornament}
\usepackage{fontspec}
\usepackage{ifpdf}
\usepackage{eso-pic}
\usepackage[british]{babel}
\usepackage{titlesec}
\usepackage{blindtext}
\usepackage{hyperref}
\usepackage{multicol}
\usepackage{xifthen}
\usepackage{csquotes}
\usepackage{ragged2e}
\usepackage{titletoc}

\setmainfont{frankrhuel}[
  % Files
  Path      = fonts/frankrhuel/ ,
  % Fonts
  UprightFont     = FrankRuehlCLM-Medium.ttf ,
  UprightFeatures = { SmallCapsFont = FrankRuehlCLM-Medium.ttf, } ,
  BoldFont        = FrankRuehlCLM-Bold.ttf,
  BoldFeatures    = { SmallCapsFont = FrankRuehlCLM-Bold.ttf } ,
  ItalicFont      = FrankRuehlCLM-MediumOblique.ttf ,
  BoldItalicFont  = FrankRuehlCLM-BoldOblique.ttf ,
  % Features
  Numbers = OldStyle ]


% old-style numbers don't look great as drop-caps
\newfontfamily{\lettrinefont}{AlegreyaSC}[
  % Files
  Path      = fonts/alegreya-sc/ ,
  % Fonts
  UprightFont     = *-Regular.ttf ,
  UprightFeatures = { SmallCapsFont = *-Regular.ttf } ,
  BoldFont        = *-Bold.ttf ,
  BoldFeatures    = { SmallCapsFont = *-Bold.ttf } ,
  ItalicFont      = *-Italic.ttf ,
  BoldItalicFont  = *-BoldItalic.ttf]



% old-style numbers don't look great as drop-caps
\newfontfamily{\headings}{AlegreyaSC}[
  % Files
  Path      = fonts/alegreya-sc/ ,
  % Fonts
  UprightFont     = *-Regular.ttf ,
  UprightFeatures = { SmallCapsFont = *-Regular.ttf } ,
  BoldFont        = *-Bold.ttf ,
  BoldFeatures    = { SmallCapsFont = *-Bold.ttf } ,
  ItalicFont      = *-Italic.ttf ,
  BoldItalicFont  = *-BoldItalic.ttf]

\setlength{\parskip}{\baselineskip}%

% book names font family and huge
\titleformat{\chapter}[display]{\Huge\headings\centering}{\chaptertitlename\ \thechapter}{20pt}{\Huge}
\titlespacing*{\chapter}{0pt}{0pt}{30pt}
\titleformat{\section}[display]{\Huge\headings\centering}{\sectiontitlename\ \thesection}{20pt}{\Huge}
\titlespacing*{\section}{0pt}{0pt}{0pt}
\titleformat{\subsection}[display]{\Large\headings}{\subsectiontitlename\ \thesubsection}{20pt}{\Large}
\titlespacing*{\subsection}{0pt}{0pt}{0pt}
\pagestyle{fancy}
\fancyhf{}


% the page number in the bottom centre of each page
\cfoot{\thepage}

\renewcommand{\headrulewidth}{0pt}


\hypersetup{colorlinks=true, linkcolor=black, urlcolor=blue, urlbordercolor={0 1 1}}

\newcommand{\framesize}{\textwidth}
\setlength{\headwidth}{\textwidth}
\setlength{\columnseprule}{0pt}

% space below the page header
\setheaderspaces{*}{0mm}{*}
\clubpenalty10000
\widowpenalty10000

\newlength{\versespacing}
\setlength{\versespacing}{.16667em plus .08333em}
\newcommand{\versespace}{\hspace{\versespacing}}
\frenchspacing

\newcommand\AtPageUpperRight[1]{\AtPageUpperLeft{%
 \put(\LenToUnit{\paperwidth},\LenToUnit{0\paperheight}){#1}%
 }}%
\newcommand\AtPageLowerRight[1]{\AtPageLowerLeft{%
 \put(\LenToUnit{\paperwidth},\LenToUnit{0\paperheight}){#1}%
 }}%

\newcommand{\sectionstyle}{\bfseries\raggedright\normaltext\fontsize{11.5}{12.5}\selectfont\headings}
\setsecheadstyle{\sectionstyle}
\setbeforesecskip{0ex}
\setaftersecskip{0.1ex}

\newcommand{\subsectionstyle}{\bfseries\itshape\raggedright\fontsize{10}{11}\selectfont\headings}
\setsubsecheadstyle{\subsectionstyle}
\setbeforesubsecskip{0ex}
\setaftersubsecskip{0.1ex}

\makeatletter
\newcommand\versenumcolor{red}
\newcommand\chapnumcolor{red}
\newlength{\biblechapskip}
  \setlength{\biblechapskip}{0}
\newcounter{biblechapter}
\newcounter{bibleverse}[biblechapter]
\renewcommand\chaptername{Book}
\newcommand{\customsection}[2][]{%
  \ifthenelse{\isempty{#1}}%
    % use the section title name for the TOC contents line
    {\section*{#2}\addcontentsline{toc}{part}{\headings{#2}}}
    % permit an override value to be used in TOC
    {\section*{#2}\addcontentsline{toc}{part}{\headings{#1}}}
}
\newcommand{\biblebook}[2][]{%
  \setcounter{biblechapter}{0}
  \ifthenelse{\isempty{#1}}%
    % use the section title name for the TOC contents line
    {\gdef\currbook{#2}\chapter*{#2}\addcontentsline{toc}{chapter}{\headings{#2}}}
    % permit an override value to be used in TOC
    {\gdef\currbook{#2}\chapter*{#2}\addcontentsline{toc}{chapter}{\headings{#1}}}
}
\newcount\biblechap@svdopt
\newenvironment{biblechapter}[1][\thebiblechapter]
  {\biblechap@svdopt=#1
  \ifnum\c@biblechapter=\biblechap@svdopt\else
    \advance\biblechap@svdopt by -1\fi
  \setcounter{biblechapter}{\the\biblechap@svdopt}
  \stepcounter{biblechapter}
  \setbeforesecskip{2mm}\setbeforesubsecskip{2mm}
  \lettrine[lines=3,lhang=0,findent=2pt,nindent=0pt,loversize=0.25,realheight=true,lraise=0.4]{\lettrinefont\fontsize{30}{10}\selectfont\color{\chapnumcolor}\,\thebiblechapter\,}{}\ignorespaces}
  {\par\vspace{\biblechapskip}\setbeforesecskip{1ex}\setbeforesubsecskip{1ex}}
\newcommand{\@verse}{\fontsize{11pt}{9pt}\selectfont\stepcounter{bibleverse}\markright{{\scshape\currbook} \thebiblechapter:\thebibleverse}}
\newcommand{\@showversenum}{\ifnum\c@bibleverse=1\else{\color{\versenumcolor}{\thebibleverse}~}\fi\ignorespaces}
\renewcommand{\verse}{\@verse\@showversenum}
\newcommand{\verseWithHeading}[1]{%
  \@verse%
  \ifnum\c@bibleverse=1{\sectionstyle#1\newline}\else\vspace{\baselineskip}\newline{\sectionstyle#1}\newline\fi\@showversenum}
\newcommand{\verseWithSubheading}[1]{%
  \@verse
  \ifnum\c@bibleverse=1{\subsectionstyle#1\newline}\else\vspace{\baselineskip}\newline{\subsectionstyle#1}\newline\fi\@showversenum}
\makeatother

\newcommand{\lebnote}[2][]{% add lower corner brackets to the word, that are references to footnotes. The second argument is the sequence identifier of the footnote (or omitted)
  \@#2% @TODO - footnotes
}

%\newcommand{\startornaments}{\AddToShipoutPictureBG{%
%  \checkoddpage%
%  \ifoddpage%
%   \AtPageUpperRight{\put(-100,-55){\pgfornament[width=1.75cm,symmetry=h,color=black]{195}}}%
%   \AtPageLowerRight{\put(-100,55){\pgfornament[width=1.75cm,symmetry=v,color=black]{194}}}%
% \else%
%   \AtPageUpperLeft{\put(10,-55){\pgfornament[width=1.75cm,symmetry=h,color=black]{194}}}%
%   \AtPageLowerLeft{\put(10,55){\pgfornament[width=1.75cm,symmetry=v,color=black]{195}}}
% \fi}}

\newcommand{\stopornaments}{\ClearShipoutPictureBG}

\renewcommand{\printparttitle}[1]{%
  \thispagestyle{empty}%
  \addcontentsline{toc}{part}{#1}%
  \vspace*{\fill}%
  \begin{tikzpicture}[transform shape,every node/.style={inner sep=0pt}]%
    \node[minimum size=\framesize](vecbox){};%
  \node[inner sep=6pt, color=black] (text) at (vecbox.center){%
    \HUGE \headings{\textsc{#1}}};%
  \node[anchor=north, color=Goldenrod] (base) at (text.south){%
    \pgfornament[width=0.5*\framesize]{88}};%
  \end{tikzpicture}%
  \vspace*{\fill}}

\makechapterstyle{dash-embiggened}{%
  \chapterstyle{default}
  \setlength{\beforechapskip}{5\onelineskip}
  \renewcommand*{\printchaptername}{}
  \renewcommand*{\chapternamenum}{}
  \renewcommand*{\chapnumfont}{\normalfont\Huge}
  \settoheight{\midchapskip}{\chapnumfont 1}
  \renewcommand*{\printchapternum}{\centering \chapnumfont
    \rule[0.5\midchapskip]{1em}{0.4pt} \thechapter\
    \rule[0.5\midchapskip]{1em}{0.4pt}}
  \renewcommand*{\afterchapternum}{\par\nobreak\vskip 0.5\onelineskip}
  \renewcommand*{\printchapternonum}{\centering
                 \vphantom{\chapnumfont 1}\afterchapternum}
  \renewcommand*{\chaptitlefont}{\normalfont\HUGE\scshape}
  \renewcommand*{\printchaptertitle}[1]{\centering \chaptitlefont ##1}
  \setlength{\afterchapskip}{2.5\onelineskip}}

\chapterstyle{dash-embiggened}

\newcommand{\columnbreak}{\pagebreak}

\newcommand{\LORD}{\textsc{\headings{Lord}}\xspace}
\newcommand{\LORDs}{\textsc{\headings{Lord's}}\xspace}

\begin{document}

\title{\Huge \headings{The Holy Bible}}
\date{}
\author{}

\frontmatter

\begin{titlingpage}
\vspace*{\fill}

\begin{tikzpicture}[color=Gold,
    transform shape,
    every node/.style={inner sep=0pt}]
  \node[minimum size=\framesize,fill=Beige!10](vecbox){};
  \node[anchor=north west] at (vecbox.north west){%
    \pgfornament[width=0.2*\framesize]{131}};
  \node[anchor=north east] at (vecbox.north east){%
    \pgfornament[width=0.2*\framesize,symmetry=v]{131}};
  \node[anchor=south west] at (vecbox.south west){%
    \pgfornament[width=0.2*\framesize,symmetry=h]{131}};
  \node[anchor=south east] at (vecbox.south east){%
    \pgfornament[width=0.2*\framesize,symmetry=c]{131}};
  \node[anchor=north] at (vecbox.north){%
    \pgfornament[width=0.6*\framesize,symmetry=h]{85}};
  \node[anchor=south] at (vecbox.south){%
    \pgfornament[width=0.6*\framesize]{85}};
  \node[anchor=north,rotate=90] at (vecbox.west){%
    \pgfornament[width=0.6*\framesize,symmetry=h]{85}};
  \node[anchor=north,rotate=-90] at (vecbox.east){%
    \pgfornament[width=0.6*\framesize,symmetry=h]{85}};
  \node[inner sep=6pt, color=black] (text) at (vecbox.center){%
    \HUGE \textsc{The Holy Bible}};
  \node[anchor=north, color=Goldenrod] (base) at (text.south){%
    \pgfornament[width=0.5*\framesize]{71}};
  \node[anchor=south, color=Goldenrod] at (text.north){%
    \pgfornament[width=0.5*\framesize,symmetry=h]{71}};
\end{tikzpicture}
\vspace*{\fill}
\end{titlingpage}






\onecolumn
\renewcommand{\contentsname}{\headings{Books of The Holy Bible}}
\titlecontents{part}[3mm]{\normalsize\bfseries}{PART\space\thecontentslabel:\space\MakeUppercase}{}{\normalfont\dotfill\makebox[12mm][l]{\thecontentspage}}
\titlecontents{chapter}[3mm]{\vspace{-12pt}\normalsize}{}{}{\dotfill\makebox[12mm][l]{\thecontentspage}}


% some help from % https://tex.stackexchange.com/questions/389319/making-the-second-column-of-the-table-of-contents-clear-the-page-header
\makeatletter  
\singlespacing
\begingroup % start a TeX group
\color{colortoc}% or whatever color you wish to use
\chapter*{\contentsname
  \@mkboth{%
    \MakeUppercase\contentsname}{\MakeUppercase\contentsname}}
% If you want to turn off columns being forced to equal height, use the starred version \begin{multicols*}{2}.
\begin{multicols}{2}

  \@starttoc{toc}
\end{multicols}
\endgroup   % end of TeX group
\makeatother


\twocolumn





% a blank page on the back of the contents page - places preface on a new right-sided page
\newpage
\thispagestyle{empty}
\mbox{}


\input{leb/content/preface.tex}

\mainmatter

\part*{\headings{The Old Testament}}

% the book name, chapter and verse number at the top of the page
\fancyhead[RO,LE]{\textbf{\headings{\Large \rightmark}}}



\input{leb/content/OT/genesis.tex}\flushcolsend
\input{leb/content/OT/exodus.tex}\flushcolsend

\input{leb/content/OT/leviticus.tex}\flushcolsend
\input{leb/content/OT/numbers.tex}\flushcolsend
\input{leb/content/OT/deuteronomy.tex}\flushcolsend
\input{leb/content/OT/joshua.tex}\flushcolsend
\input{leb/content/OT/judges.tex}\flushcolsend
\input{leb/content/OT/ruth.tex}\flushcolsend
\input{leb/content/OT/1samuel.tex}\flushcolsend
\input{leb/content/OT/2samuel.tex}\flushcolsend
\input{leb/content/OT/1kings.tex}\flushcolsend
\input{leb/content/OT/2kings.tex}\flushcolsend
\input{leb/content/OT/1chronicles.tex}\flushcolsend
\input{leb/content/OT/2chronicles.tex}\flushcolsend
\input{leb/content/OT/ezra.tex}\flushcolsend
\input{leb/content/OT/nehemiah.tex}\flushcolsend
\input{leb/content/OT/esther.tex}\flushcolsend
\input{leb/content/OT/job.tex}\flushcolsend
\input{leb/content/OT/psalms.tex}\flushcolsend
\input{leb/content/OT/proverbs.tex}\flushcolsend
\input{leb/content/OT/ecclesiastes.tex}\flushcolsend
\input{leb/content/OT/songofsolomon.tex}\flushcolsend
\input{leb/content/OT/isaiah.tex}\flushcolsend
\input{leb/content/OT/jeremiah.tex}\flushcolsend
\input{leb/content/OT/lamentations.tex}\flushcolsend
\input{leb/content/OT/ezekiel.tex}\flushcolsend
\input{leb/content/OT/daniel.tex}\flushcolsend
\input{leb/content/OT/hosea.tex}\flushcolsend
\input{leb/content/OT/joel.tex}\flushcolsend
\input{leb/content/OT/amos.tex}\flushcolsend
\input{leb/content/OT/obadiah.tex}\flushcolsend
\input{leb/content/OT/jonah.tex}\flushcolsend
\input{leb/content/OT/micah.tex}\flushcolsend
\input{leb/content/OT/nahum.tex}\flushcolsend
\input{leb/content/OT/habakkuk.tex}\flushcolsend
\input{leb/content/OT/zephaniah.tex}\flushcolsend
\input{leb/content/OT/haggai.tex}\flushcolsend
\input{leb/content/OT/zechariah.tex}\flushcolsend
\input{leb/content/OT/malachi.tex}\flushcolsend



\setlrmarginsandblock{13.5mm}{8.5mm}{*}


\part*{\headings{The New Testament}}


\input{leb/content/NT/matthew.tex}\flushcolsend
\input{leb/content/NT/mark.tex}\flushcolsend
\input{leb/content/NT/luke.tex}\flushcolsend

\input{leb/content/NT/john.tex}\flushcolsend
\input{leb/content/NT/acts.tex}\flushcolsend
\input{leb/content/NT/romans.tex}\flushcolsend
\input{leb/content/NT/1corinthians.tex}\flushcolsend
\input{leb/content/NT/2corinthians.tex}\flushcolsend
\input{leb/content/NT/galatians.tex}\flushcolsend
\input{leb/content/NT/ephesians.tex}\flushcolsend
\input{leb/content/NT/philippians.tex}\flushcolsend
\input{leb/content/NT/colossians.tex}\flushcolsend
\input{leb/content/NT/1thessalonians.tex}\flushcolsend
\input{leb/content/NT/2thessalonians.tex}\flushcolsend
\input{leb/content/NT/1timothy.tex}\flushcolsend
\input{leb/content/NT/2timothy.tex}\flushcolsend
\input{leb/content/NT/titus.tex}\flushcolsend
\input{leb/content/NT/philemon.tex}\flushcolsend
\input{leb/content/NT/hebrews.tex}\flushcolsend
\input{leb/content/NT/james.tex}\flushcolsend
\input{leb/content/NT/1peter.tex}\flushcolsend
\input{leb/content/NT/2peter.tex}\flushcolsend
\input{leb/content/NT/1john.tex}\flushcolsend
\input{leb/content/NT/2john.tex}\flushcolsend
\input{leb/content/NT/3john.tex}\flushcolsend
\input{leb/content/NT/jude.tex}\flushcolsend
\input{leb/content/NT/revelation.tex}\flushcolsend

\end{document}
